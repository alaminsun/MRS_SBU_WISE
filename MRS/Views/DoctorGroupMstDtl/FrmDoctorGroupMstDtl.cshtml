@{
    ViewBag.Title = "FrmDoctorGroupMstDtl";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<title>@ViewBag.formTitle</title>



<div class="row box box-danger">
    <div class="col-lg-6">
        <span id="MessageText" class="pull-right"></span>
    </div>
    <div class="col-lg-6">
        <button type="button" id="btnReset" class=" btn bg-olive btn-flat margin pull-right"><i class="glyphicon glyphicon-refresh"></i> Reset</button>
        <button type="button" id="btnDelete" class=" btn bg-olive btn-flat margin pull-right"><i class="glyphicon glyphicon-remove"></i> Delete</button>
        <button type="button" id="btnSearch" class=" btn bg-olive btn-flat margin pull-right"><i class="glyphicon glyphicon-search"></i> Search</button>
        <button type="button" id="btnSubmit" onclick="Save()" class=" btn bg-olive btn-flat margin pull-right"><i class="glyphicon glyphicon-save"></i> Save</button>

    </div>
</div>
<div class="row box box-primary">
    <form class="form">
        <div class="box-body">
            <div class="form-group">
                <div class="box-header with-border">
                    <h3 class="box-title">Input Doctor Group Information</h3>
                </div>
                <div class="form-group">
                    <div class="col-lg-2">
                        <label>Group Id</label><label style="color: red">*</label>
                    </div>
                    <div class="col-lg-4">
                        <input type="hidden" id="SUStatus" class="txtBox" />
                        <input type="hidden" class="txtBox" id="DOC_GRP_MAS_SLNO" />
                        <input type="text" id="GROUP_ID" placeholder="Press F9" class="txtBox RequiredTextBox SetFocus" name="GROUP_ID" tabindex="1" readonly="readonly" />
                    </div>
                    <div class="col-lg-2">
                        <label>Group Name</label><label style="color: red">*</label>
                    </div>
                    <div class="col-lg-4">
                        <input type="text" id="GROUP_NAME" class="txtBox RequiredTextBox" name="GROUP_NAME" tabindex="2" readonly="readonly" />
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<div class="row box box-primary">
    <form class="form">
        <div class="box-body">
            <div class="form-group">
                <div class="box-header with-border">
                    <h3 class="box-title">Browse & Upload File For RSM Details</h3>
                </div>

                <div class="col-lg-12">
                    <input name="files" class="files" id="files" type="file">
                    @*<div class="col-lg-6">
                            <div class="input-group" style="margin-top: 10px">
                                <span class="input-group-btn">
                                    <span class="btn btn-primary btn-file">
                                        Browse&hellip; <input name="files" class="files" id="files" type="file" >
                                    </span>
                                </span>
                                <input type="text" class="form-control"  tabindex="4">
                            </div>
                        </div>*@
                    @*<div class="col-lg-6">
                            <button type="button" id="btnUpload" class=" btn bg-olive btn-flat margin pull-right"><i class="glyphicon glyphicon-upload"></i> Upload Details</button>
                        </div>*@
                </div>
            </div>
        </div>
    </form>
</div>

<div class="row box box-success">
    <div class="box-header with-border">
        <h3 class="box-title">Doctor Details</h3>
    </div>
    <div id="PageDetailGrid" class="grdKendo" tabindex="3"></div>
</div>

<div id="DeleteConfirmWindow" style="display: none;">
    <p><h5>Are you sure to delete?</h5></p>
    <input type="button" style="height: 25px; width: 60px; margin-left: 10px; float: left;" id="btnConfirmationOK" value="OK" />
    <input type="button" style="height: 25px; width: 60px; margin-left: 30px; float: left;" id="btnConfirmationCancel" value="Cancel" />
</div>

<div id="SaveChangeWindow" style="display: none;">
    <p><h5>Data will be lost if you continue.</h5></p>
    <input type="button" class="ThreeButtonWindow" id="btnSaveChangeWindowOk" value="OK" />
    <input type="button" class="ThreeButtonWindow" id="btnSaveChangeWindowCancel" value="Cancel" />
</div>

<div id="GroupWindow" style="display: none;">
    <div id="GroupGrid" class="PopUpGrid">
    </div>
    <input type="button" id="btnGroupWindowCancel" class="PopUpButton" value="Cancel" />
    <input type="button" id="btnGroupWindowOK" class="PopUpButton" value="OK" />
</div>
<div id="DoctorWindow" style="display: none;">
    <div id="DoctorGrid" class="PopUpGrid">
    </div>
    <input type="button" id="btnDoctorWindowCancel" class="PopUpButton" value="Cancel" />
    <input type="button" id="btnDoctorWindowOK" class="PopUpButton" value="OK" />
</div>
<div id="SearchWindow" style="display: none;">
    @*<p>ZoneDivi:<input type="text" id="txtBuyer" style="width: 250px;" /><input type="button" id="btnGridSearch" value="Search" /></p>*@

    <div id="SearchWindowGrid" class="PopUpGrid">
    </div>
    <input type="button" id="btnSearchWindowCancel" class="PopUpButton" value="Cancel" />
    <input type="button" id="btnSearchWindowOK" class="PopUpButton" value="OK" />
</div>

<div id="divLoading" style="margin: 0px; padding: 0px; position: fixed; right: 0px; top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001; opacity: .8; filter: alpha(opacity=70); display: none">
    <p style="position: absolute; top: 50%; left: 42%; color: White;">
        Loading, please wait...<img src="~/Content/Images/cube.gif" />
    </p>
</div>

<style>
    .gridHeader {
        background: #B4EEB4;
    }

    .box {
        background: #FFFAF0;
    }
</style>



<script type="text/javascript">

    //$(document).ready(function () {
    //    // This is the simple bit of jquery to duplicate the hidden field to subfile
    //    $('#pdffile').change(function () {
    //        $('#subfile').val($(this).val());
    //    });

    //    // This bit of jquery will show the actual file input box
    //    $('#showHidden').click(function () {
    //        $('#pdffile').css('visibilty', 'visible');
    //    });
    //});
    // To Declare Global Variable
    var changeStatus = 0;
    var resetEditDeleteStatus = 0;
    var deleteStatus = 0;
    var dataitem = {};


    //// Start  $(document).ready(function ()
    $(document).ready(function () {
        // Delete Button
        $("#btnDelete").click(function () {
            resetEditDeleteStatus = 3; //Delete Button
            deleteStatus = 1; //For Year
            // When Chages Data
            if (changeStatus == 1)
                OpenSaveChangesDialog();
                // When no Chages Data
            else {
                OpenConfirmationDialog();
            }
        });


        $('#SUStatus').val(0);

        //******************************DECLARE GRID DELETE ROW EVENT FOR PAGEDETAILGRID **************************************//
        function handleDoctorGroupMstDtlDelete() {
            deleteStatus = 2;
            var grid1 = $("#PageDetailGrid").data("kendoGrid");
            dataitem = (grid1.dataItem(grid1.select())); //Selected Row
            //dataitem = grid.dataItem($(event.currentTarget).closest("tr"));
            if (changeStatus == 0) {
                OpenConfirmationDialog();
            } else {
                resetEditDeleteStatus = 3; //Delete Division Grid Button
                OpenSaveChangesDialog();
            }
        };

        //***************************************To Define Data TC_L1_L2 for Kendo Grid******************************************//
        var dataSourceDivisionInfo = new kendo.data.DataSource({
            batch: true,
            schema: {
                model: {
                    id: "DOC_GRP_DET_SLNO",
                    fields: {
                        DOC_GRP_DET_SLNO: { editable: false },
                        DOC_GRP_MAS_SLNO: { editable: false },
                        DOCTOR_ID: { editable: true, defaultValue: 'Press F9' },
                        DOCTOR_NAME: { editable: true },
                        DEGREE: { editable: true },
                        DESIGNATION: { editable: true },
                        SPECIALIZATION: { editable: true },
                    }
                }
            },
            pageSize: 10
        });


        var gridDoctorGroupMstDtlInfo = $('#PageDetailGrid').kendoGrid({
            dataSource: dataSourceDivisionInfo,
            width: 430,
            pageable: true,
            edit: function (e) {
                $("input[name=DOCTOR_ID]").attr("readonly", true);
                $("input[name=DOCTOR_NAME]").attr("readonly", true);
                $("input[name=DEGREE]").attr("readonly", true);
                $("input[name=DESIGNATION]").attr("readonly", true);
                $("input[name=SPECIALIZATION]").attr("readonly", true);
            },
            selectable: "row",
            toolbar: [{ text: "Add Doctor Details ", className: "btnAddDoctor", imageClass: "k-icon k-add" }],
            navigatable: true,
            filterable: true,
            sortable: true,
            columns: [
                { field: "DOC_GRP_DET_SLNO", hidden: true },
                { field: "DOC_GRP_MAS_SLNO", hidden: true },
                { field: "DOCTOR_ID", title: "Doctor Id", filterable: false, width: 50, attributes: { "class": "_doctorCode" }, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                { field: "DOCTOR_NAME", title: "Doctor Name", filterable: false, width: 180, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                { field: "DEGREE", title: "Degree", filterable: false, width: 120, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                { field: "DESIGNATION", title: "Designation", filterable: false, width: 150, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                { field: "SPECIALIZATION", title: "Specialization", filterable: false, width: 100, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
                { command: [{ name: "DeletedRow", text: "Delete", imageClass: "k-icon k-i-close", click: handleDoctorGroupMstDtlDelete }], title: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delete", width: "50px", headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } }
            ]
        }).data('kendoGrid');



        //****************************************To Define Columns for TC_L1_L2 Kendo Grid***************************************//
        $(".btnAddDoctor").click(function () {
            var DoctorGridRow = $("#PageDetailGrid").data("kendoGrid");
            $("#PageDetailGrid").data().kendoGrid.bind('dataBound', function () {
                this.element.find('tbody tr:first').addClass('k-state-selected');
            });
            DoctorGridRow.addRow();
        });

        $("#PageDetailGrid").keyup(function (e) {
            if (e.keyCode == 13) {
                var DoctorGridRow = $("#PageDetailGrid").data("kendoGrid");
                $("#PageDetailGrid").data().kendoGrid.bind('dataBound', function () {
                    this.element.find('tbody tr:first').addClass('k-state-selected');
                });
                DoctorGridRow.addRow();
            }
        });

        //var ddlStatusDataSource = [{ text: "Active", value: "Active" }, { text: "Inactive", value: "Inactive" }];

        //function ddlStatus(container, options) {
        //    $('<input data-bind="value:' + options.field + '"/>')
        //        .appendTo(container)
        //        .kendoDropDownList({
        //            dataTextField: "text",
        //            dataValueField: "value",
        //            optionLabel: "Select",
        //            autoBind: false,
        //            change: function () {
        //                changeStatus = 1;
        //            },
        //            dataSource: ddlStatusDataSource
        //        });
        //};


        //Handling Yes button click for grid row deletion
        $('#btnConfirmationOK').click(function () {
            if (deleteStatus == 1) {
                if ($("#DOC_GRP_MAS_SLNO").val() != "") {
                    $.ajax({
                        url: '@Url.Action("DeleteAllList", "DoctorGroupMstDtl")',
                        type: 'POST',
                        data: JSON.stringify({ "doctorGroupMstSlNo": $("#DOC_GRP_MAS_SLNO").val() }),
                        contentType: 'application/json;',
                        dataType: 'json',
                        success: function (respnse) {
                            if (respnse.msg.Type == 2) {
                                ClearOperationalMessage();
                                ResetOnlyMasterPageData();
                                $(".RequiredTextBox").css("border-color", "");
                                $("#PageDetailGrid").data("kendoGrid").dataSource.data([]);
                                $('#MessageText').html(respnse.msg.Msg);
                                $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            } else {
                                $("#MessageText").html(respnse.msg.Msg);
                                $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            }
                        }
                    });
                }
                $(".RequiredTextBox").css("border-color", "");
                CloseConfirmationDialog();
            } else if (deleteStatus == 2) {
                if (dataitem.DOC_GRP_DET_SLNO != null && dataitem.DOC_GRP_DET_SLNO != "") {
                    $.ajax({
                        url: '@Url.Action("DeleteDetailList", "DoctorGroupMstDtl")',
                        type: 'POST',
                        data: JSON.stringify({ "doctorGroupDtlSlNo": dataitem.DOC_GRP_DET_SLNO }),
                        contentType: 'application/json;',
                        dataType: 'json',
                        success: function (respnse) {
                            if (respnse.msg.Type == 2) {
                                $('#MessageText').html(respnse.msg.Msg);
                                $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                                $("#PageDetailGrid").data("kendoGrid").dataSource.remove(dataitem);
                            } else {
                                $("#MessageText").html(respnse.msg.Msg);
                                $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            }
                        }
                    });
                } else {
                    $("#PageDetailGrid").data("kendoGrid").dataSource.remove(dataitem);
                    $('#MessageText').html("Grid Row Deleted Successfully");
                    $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                }
                $(".RequiredTextBox").css("border-color", "");
                CloseConfirmationDialog();
            }
        });

        //Handling No button click for grid row deletion
        $('#btnConfirmationCancel').click(function () {
            dataitem = {};
            CloseConfirmationDialog();
        });

        //To clear operational/error message
        ClearOperationalMessage();

        //For removing operational & required message after triggering other event
        ClearRequiredTextBoxRedColor();

        // To check unsaved data in master or details
        CheckUnSavedMasterDetailData();

        // Focus ZONE_CODE textbox
        $(".SetFocus").focus();

        // Click Save Chages Popup No Button
        $("#btnSaveChangeWindowOk").click(function () {
            if (resetEditDeleteStatus == 1) { // Reset
                ResetOnlyMasterPageData();
                $(".RequiredTextBox").css("border-color", "");
                $("#PageDetailGrid").data("kendoGrid").dataSource.data([]);
                changeStatus = 0;
                CloseSaveChangesDialog();
            } else if (resetEditDeleteStatus == 2) { // Search
                ResetOnlyMasterPageData();
                $(".RequiredTextBox").css("border-color", "");
                $("#PageDetailGrid").data("kendoGrid").dataSource.data([]);
                changeStatus = 0;
                CloseSaveChangesDialog();
                GetMasterInformation();
                SelectedItemOfListOfValue('SearchWindowGrid');
                SearchWindow.open();
            } else if (resetEditDeleteStatus == 3) { // Delete Button
                if (deleteStatus == 1) {
                    if ($("#DOC_GRP_MAS_SLNO").val() != "") {
                        $.ajax({
                            url: '@Url.Action("DeleteAllList", "DoctorGroupMstDtl")',
                            type: 'POST',
                            data: JSON.stringify({ "doctorGroupMstSlNo": $("#DOC_GRP_MAS_SLNO").val() }),
                            contentType: 'application/json;',
                            dataType: 'json',
                            success: function (respnse) {
                                if (respnse.msg.Type == 2) {
                                    ClearOperationalMessage();
                                    ResetOnlyMasterPageData();
                                    $(".RequiredTextBox").css("border-color", "");

                                    $("#PageDetailGrid").data("kendoGrid").dataSource.data([]);
                                    $('#MessageText').html(respnse.msg.Msg);
                                    $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                                } else {
                                    $('#MessageText').html(respnse.msg.Msg);
                                    $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                                }
                            }
                        });
                    }
                    $(".RequiredTextBox").css("border-color", "");
                    changeStatus = 0;
                    dataitem = {};
                    CloseSaveChangesDialog();
                } else if (deleteStatus == 2) {
                    if (dataitem.DOC_GRP_DET_SLNO != "") {
                        $.ajax({
                            url: '@Url.Action("DeleteDetailList", "DoctorGroupMstDtl")',
                            type: 'POST',
                            data: JSON.stringify({ "doctorGroupDtlSlNo": dataitem.DOC_GRP_DET_SLNO }),
                            contentType: 'application/json;',
                            dataType: 'json',
                            success: function (respnse) {
                                if (respnse.msg.Type == 2) {
                                    $('#MessageText').html(respnse.msg.Msg);
                                    $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                                    $("#PageDetailGrid").data("kendoGrid").dataSource.remove(dataitem);
                                } else {
                                    $('#MessageText').html(respnse.msg.Msg);
                                    $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                                }
                            }
                        });
                    } else {
                        $('#MessageText').html("Deleted Successfully.");
                        $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                        $("#PageDetailGrid").data("kendoGrid").dataSource.remove(dataitem);
                    }
                    $(".RequiredTextBox").css("border-color", "");
                    //changeStatus = 0;
                    dataitem = {};
                    CloseSaveChangesDialog();
                }
            }
            else
                CloseSaveChangesDialog();
        });

        // Click Save Chages Popup Cancel Button
        $("#btnSaveChangeWindowCancel").click(function () {
            CloseSaveChangesDialog();
        });

        // **       Page Unloaded **//
        window.onbeforeunload = function (e) {
            if (changeStatus == 1) {
                e.preventDefault();
            }
        };
        //  **       Page Unloaded **//
    });
    // ** End Start Document .Ready


    //********************************************** Therapeutic Leve-1 POP UP Window ****************************************************

    //*********** DEFINE Therapeutic Leve-1 Window ***************************** //

    var GroupWindow = $('#GroupWindow').kendoWindow({
        actions: ["Minimize", "Maximize", "Close"],
        visible: false,
        //width: "1352px",
        width: "100%",
        height: "auto",
        title: "List of Group Data",
        position: { top: 100, left: 50 },
        modal: true,
        draggable: true
    }).data('kendoWindow');
    //*********** DEFINE District GRID ***************************** //

    var TherapeuticLevel1DataSource = new kendo.data.DataSource({
        schema: {
            model: {
                id: "GROUP_ID",
                fields: {
                    GROUP_ID: { editable: false, hidden: true },
                    GROUP_NAME: { editable: false }

                }
            }
        },
        pageSize: 10
    });

    var GroupGrid = $("#GroupGrid").kendoGrid({
        dataSource: TherapeuticLevel1DataSource,
        pageable: true,
        editable: true,
        selectable: "row",
        navigatable: true,
        sortable: true,
        height: 350,
        filterable: {
            extra: false,
            operators: {
                string: {
                    startswith: "Starts with",
                    contains: "Contains"
                }
            }
        },

        columns: [
            { field: "GROUP_NAME", title: "Group Name", width: "150px", filterable: true, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
            { field: "GROUP_ID", title: "Group Id", width: "150px", filterable: true, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } }


        ]
    });




    //Open PopUp by pressing F9 key
    $(document.body).keyup(function (e) {
        if ($("#GROUP_ID").is(":focus")) {
            if (e.keyCode == 120) {
                $("#divLoading").show();
                $.ajax({
                    url: '@Url.Action("GetGroupData", "DoctorGroupMstDtl")',
                    type: "GET",
                    dataType: "JSON",
                    success: function (data) {
                        $("#divLoading").hide();
                        $("#GroupGrid").data("kendoGrid").dataSource.data(data);
                    },
                    complete: function (data) {
                        $("#divLoading").hide();
                    }
                });
                SelectedItemOfListOfValue('GroupGrid');
                GroupWindow.open();
                GroupWindow.center();
            }
        }
    });



    //Press Ok button after Select Data From PopUp
    $('#btnGroupWindowOK').click(function () {
        ListOfValueOpeningBankGridEvent('GroupGrid');
        GroupWindow.close();
    });


    //Press Cancel button after Select Data From PopUp
    $('#btnGroupWindowCancel').click(function () {
        GroupWindow.close();
    });


    // Select Data through double Click From PopUp
    $("#GroupWindow").dblclick(function () {
        ListOfValueOpeningBankGridEvent('GroupGrid');
        GroupWindow.close();
    });


    // Select Data through keyup From PopUp
    $("#GroupWindow").keyup(function (event) {
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if (keycode == '13') {
            ListOfValueOpeningBankGridEvent('GroupGrid');
            GroupWindow.close();
        }
        else if (keycode == '27') {
            GroupWindow.close();
        }
        event.stopPropagation();
    });


    //To Bring Data from List of Value Grid to Main Page
    function ListOfValueOpeningBankGridEvent(gridName) {
        var grid = $('#' + gridName).data("kendoGrid");
        var selectedItem = (grid.dataItem(grid.select()));
        $.each(selectedItem, function (key, value) {
            if (value != null && value != 0)
                $('#' + key).val(value);
        });
        $("#GROUP_ID").val(selectedItem.GROUP_ID);
        $("#GROUP_NAME").val(selectedItem.GROUP_NAME);
        changeStatus = 1;
    }


    //Select Data from Pop up Grid
    function SelectedItemOfListOfValue(gridName) {
        var grid = $('#' + gridName).data("kendoGrid");
        grid.dataSource.read();
        $('#' + gridName).data("kendoGrid").dataSource.filter([]);
        $('#' + gridName).data().kendoGrid.bind('dataBound', function (e) {
            this.element.find('tbody tr:first').addClass('k-state-selected');
        });
    }

    //********************************************** END of Therapeutic Leve-1 POP UP Window ****************************************************//

    //********************************************** Upazila POP UP Window ****************************************************

    //*********** DEFINE Therapeutic Leve-2 Window ***************************** //

    var DoctorWindow = $('#DoctorWindow').kendoWindow({
        actions: ["Minimize", "Maximize", "Close"],
        visible: false,
        width: "100%",
        height: "auto",
        title: "List of Doctor Detail Data",
        position: { top: 100, left: 50 },
        modal: true,
        draggable: true
    }).data('kendoWindow');

    //*********** DEFINE Therapeutic Leve-2 GRID ***************************** //

    var TherapeuticLevel2DataSource = new kendo.data.DataSource({
        schema: {
            model: {
                id: "DOCTOR_ID",
                fields: {
                    DOCTOR_ID: { editable: false, hidden: true },
                    DOCTOR_NAME: { editable: false }

                }
            }
        },
        pageSize: 10
    });

    var DoctorGrid = $("#DoctorGrid").kendoGrid({
        dataSource: TherapeuticLevel2DataSource,
        pageable: true,
        editable: true,
        selectable: "row",
        navigatable: true,
        sortable: true,
        height: 350,
        filterable: {
            extra: false,
            operators: {
                string: {
                    startswith: "Starts with",
                    contains: "Contains"
                }
            }
        },

        columns: [
            { field: "DOCTOR_NAME", title: "Doctor Name", width: "150px", filterable: true, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } },
            { field: "DOCTOR_ID", title: "Doctor Id", width: "150px", filterable: true, headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;" } }

        ]
    });


    $(document).on('keyup', '._doctorCode', function (e) {
        if (e.keyCode == 120) {
            //GetDiviInfoList();
            $("#divLoading").show();
            $.ajax({
                url: '@Url.Action("GetDoctorData", "DoctorGroupMstDtl")',
                type: "GET",
                dataType: "JSON",
                success: function (data) {
                    $("#divLoading").hide();
                    $("#DoctorGrid").data("kendoGrid").dataSource.data(data);
                },
                complete: function (data) {
                    $("#divLoading").hide();
                }
            });
            SelectedItemOfListOfValue('DoctorGrid');
            DoctorWindow.open();
            DoctorWindow.center();
        }
    });

    @*//Open PopUp by pressing F9 key
    $(document.body).keyup(function (e) {
        if ($("#DOCTOR_ID").is(":focus")) {
            if (e.keyCode == 120) {
                $("#divLoading").show();
                $.ajax({
                    url: '@Url.Action("GetDoctorGroupMstDtlDtlData", "DoctorGroupMstDtl")',
                    type: "GET",
                    dataType: "JSON",
                    success: function (data) {
                        $("#divLoading").hide();
                        $("#DoctorGrid").data("kendoGrid").dataSource.data(data);
                    },
                    complete: function (data) {
                        $("#divLoading").hide();
                    }
                });
                SelectedItemOfListOfValue('DoctorGrid');
                DoctorWindow.open();
                DoctorWindow.center();
            }
        }
    });*@



    //Press Ok button after Select Data From PopUp
    $('#btnDoctorWindowOK').click(function () {
        ListOfValueGridEventDiviInfo('DoctorGrid');
        DoctorWindow.close();
    });


    //Press Cancel button after Select Data From PopUp
    $('#btnDoctorWindowCancel').click(function () {
        TherapeuticLevel2DataSource.close();
    });


    // Select Data through double Click From PopUp
    $("#DoctorWindow").dblclick(function () {
        ListOfValueGridEventDiviInfo('DoctorGrid');
        DoctorWindow.close();
    });


    // Select Data through keyup From PopUp
    $("#DoctorWindow").keyup(function (event) {
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if (keycode == '13') {
            ListOfValueGridEventDiviInfo('DoctorGrid');
            DoctorWindow.close();
        }
        else if (keycode == '27') {
            DoctorWindow.close();
        }
        event.stopPropagation();
    });


    //To Bring Data from List of Value Grid to Main Page
    //function ListOfValueGridEventDiviInfo(gridName) {
    //    var grid = $('#' + gridName).data("kendoGrid");
    //    var selectedItem = (grid.dataItem(grid.select()));
    //    $.each(selectedItem, function (key, value) {
    //        if (value != null && value != 0)
    //            $('#' + key).val(value);
    //    });
    //    $("#DOCTOR_ID").val(selectedItem.DOCTOR_ID);
    //    $("#DOCTOR_NAME").val(selectedItem.DOCTOR_NAME);
    //}
    //To Bring Data from List of Value Grid to Main Page
    function ListOfValueGridEventDiviInfo(gridName) {
        var grid = $('#' + gridName).data("kendoGrid");
        var selectedItem = (grid.dataItem(grid.select())); //Selected Row

        var pageGrid = $("#PageDetailGrid").data("kendoGrid");
        var pageGridItem = pageGrid.dataItem(pageGrid.select());

        pageGridItem.set("DOCTOR_ID", selectedItem.DOCTOR_ID);
        pageGridItem.set("DOCTOR_NAME", selectedItem.DOCTOR_NAME);
        pageGridItem.set("DEGREE", selectedItem.DEGREE);
        pageGridItem.set("DESIGNATION", selectedItem.DESIGNATION);
        pageGridItem.set("SPECIALIZATION", selectedItem.SPECIALIZATION);
        changeStatus = 1;
    }



    //********************************************** END of Therapeutic Leve-2 POP UP Window ****************************************************//


    //************************************ Declare View Model Object for TC_L1_L2 Relation ****************************************//
    //var DoctorGroupDtlViewModel = { "DOC_GRP_DET_SLNO": "", "DOC_GRP_MAS_SLNO": "", "DOCTOR_ID": "" };
    //var model = { "DOC_GRP_MAS_SLNO": "", "GROUP_ID": "", "DoctorGroupDtlList": [] };
    var model = { "DOC_GRP_MAS_SLNO": "", "GROUP_ID": "", "DoctorGroupDtlList": [] };
    var saveStatus = 1;
    // Save Or Update Data
    function Save() {

        saveStatus = 1;

        // Check Maximum Length for declared Text field
        CheckRequiredTextBoxMaxLength('GROUP_ID', 10);
        CheckRequiredTextBoxMaxLength('GROUP_NAME', 100);

        // Check Save Proper Data
        if (saveStatus == 1) {
            model.GROUP_ID = $("#GROUP_ID").val();
            model.DOC_GRP_MAS_SLNO = $("#DOC_GRP_MAS_SLNO").val();
            model.SUStatus = $("#SUStatus").val();
            //alert(model.SUStatus);
            //alert(DoctorGroupMstViewModel.GROUP_ID);
            //DoctorGroupMstViewModel.DOC_GRP_MAS_SLNO = $("#DOC_GRP_MAS_SLNO").val();
            var dataSource = $("#PageDetailGrid").data("kendoGrid").dataSource;
            var data = dataSource.data(); // Get Detail Grid Data

            model.DoctorGroupDtlList = [];
            if (data.length > 0) {
                //for (var i = 0; i <= data.length - 1; i++) {
                for (var i = 0; i < data.length; i++) {
                    var detail = {};
                    //if (data[i].dirty) {
                    detail.DOC_GRP_DET_SLNO = data[i].DOC_GRP_DET_SLNO;
                    detail.DOC_GRP_MAS_SLNO = data[i].DOC_GRP_MAS_SLNO;
                    detail.DOCTOR_ID = data[i].DOCTOR_ID;

                    model.DoctorGroupDtlList.push(detail);
                    //DoctorGroupDtlViewModel = { "DOC_GRP_DET_SLNO": "", "DOC_GRP_MAS_SLNO": "", "DOCTOR_ID": "" };
                    //}
                }
            }

            if (model.DOC_GRP_MAS_SLNO == "") {

                // INSERT DATA
                $("#divLoading").show();

                $.ajax({
                    url: '/DoctorGroupMstDtl/Save',
                    data: JSON.stringify(model),
                    type: 'POST',
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data) {
                        //console.log(data);
                        if (data.msg.Type == 2) {
                            ////$("#divLoading").hide();
                            //$("#CnfBillNo").val(data.ReturnCode);
                            //$("#CnfBillID").val(data.ReturnId);


                            //$('#MessageText').html(data.msg.Msg);
                            //$("#MessageText").css({ 'text-align': "center", 'color': "green", 'font-weight': "bold", 'font-size': "17px" });
                            ////Reset();

                            if (data.msg.Type == 2) {
                                changeStatus = 0;
                                $("#SUStatus").val(1);
                                $('#DOC_GRP_MAS_SLNO').val(data.DOC_GRP_MAS_SLNO);
                                $('#MessageText').html(data.msg.Msg);
                                $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            }
                                //else if (response.msg.Type == 3) {
                                //    changeStatus = 0;
                                //    $('#MessageText').html(response.msg.Msg);
                                //    $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });

                                //}
                            else if (data.msg.Type == 1) {
                                $('#MessageText').html(data.msg.Msg);
                                $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            }
                            else {
                                changeStatus = 0;
                                $('#MessageText').html(data.msg.Msg);
                                $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            }

                        }
                        //else {
                        //    $("#MessageText").html(data.msg.Msg);
                        //    $("#MessageText").css("color", "red");
                        //}
                    },
                    error: function (data) {
                        // alert("Failed: " + respnse.status + ": " + respnse.statusText);
                    },

                    complete: function (data) {
                        $("#divLoading").hide();
                    }
                });

    @*$.ajax({
        url: '@Url.Action("SaveAndUpdate", "DoctorGroupMstDtl", Request.RequestContext.RouteData.Values)',
        type: 'POST',
        traditional: true,
        dataType: "json",
        contentType: "application/json",
        data: kendo.stringify(model),
        success: function () { window.alert('saved'); }
    });*@
            }
            else {
                // UPDATE DATA
                $.ajax({
                    type: "Post",
                    url: '@Url.Action("Update", "DoctorGroupMstDtl")',
                    data: JSON.stringify(model),
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (data) {
                        //if (data.msg.Type == 3) {
                        //    $('#MessageText').html(data.msg.Msg);
                        //    $("#MessageText").css({ 'text-align': "center", 'color': "green", 'font-weight': "bold", 'font-size': "17px" });
                        //}
                        //else {
                        //    $("#MessageText").html(data.msg.Msg);
                        //    $("#MessageText").css("color", "red");
                        //}
                        if (data.msg.Type == 2) {
                            $("#SUStatus").val(1);
                            $('#DOC_GRP_MAS_SLNO').val(data.DOC_GRP_MAS_SLNO);
                            $('#MessageText').html(data.msg.Msg);
                            $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                        }
                        else if (data.msg.Type == 1) {
                            $('#MessageText').html(data.msg.Msg);
                            $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                        } else {
                            $("#MessageText").html("No Changes to Save.");
                            $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                            $("#GROUP_ID").focus();
                        }

                    },
                    error: function (data) {
                        // alert("Failed: " + respnse.status + ": " + respnse.statusText);
                    },
                    failure: function (data) {

                    }
                });
           }















    @*if (changeStatus == 1) {
                $.ajax({
                    url: '@Url.Action("SaveAndUpdate", "DoctorGroupMstDtl")',
                    data: JSON.stringify(DoctorGroupMstViewModel),
                    type: 'POST',
                    contentType: 'application/json;',
                    dataType: 'json',
                    success: function (response) {
                        if (response.msg.Type == 2) {
                            changeStatus = 0;
                            $("#SUStatus").val(1);
                            $('#DOC_GRP_MAS_SLNO').val(response.DOC_GRP_MAS_SLNO);
                            $('#MessageText').html(response.msg.Msg);
                            $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });

                        }
                        else if (response.msg.Type == 3) {
                            changeStatus = 0;
                            $('#MessageText').html(response.msg.Msg);
                            $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });

                        }
                        else if (response.msg.Type == 1) {
                            $('#MessageText').html(response.msg.Msg);
                            $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                        }
                        else {
                            changeStatus = 0;
                            $('#MessageText').html(response.msg.Msg);
                            $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                        }
                    }
                });
            }
            // No Changes Exiting Data
            else {
                $("#MessageText").html("No Changes to Save.");
                $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                $("#GROUP_ID").focus();
            }*@
    }
    };
    $("#btnReset").click(function () {
        resetEditDeleteStatus = 1; //Reset Button
        // When Chages Data
        if (changeStatus == 1)
            OpenSaveChangesDialog();
            // When no Chages Data
        else {
            ClearOperationalMessage();
            ResetOnlyMasterPageData();
            $(".RequiredTextBox").css("border-color", "");
            $("#PageDetailGrid").data("kendoGrid").dataSource.data([]);
            $("#files").val('');
            $(".txtBox").css("border-color", "");
            $(".k-upload-files").remove();
            $(".k-upload-status").remove();
            $(".k-upload.k-header").addClass("k-upload-empty");
            $(".k-upload-button").removeClass("k-state-focused");
        }
    });



    //******************************************** SEARCH DoctorGroupMstDtl DATA **********************************************************//
    var SearchWindow = $('#SearchWindow').kendoWindow({
        actions: ["Minimize", "Maximize", "Close"],
        visible: false,
        width: "auto",
        height: "auto",
        title: "Search Doctor Group Master & Detail Data Data",
        position: { top: 50, left: 5 },
        modal: true,
        draggable: true
    }).data('kendoWindow');

    $("#btnSearch").click(function () {
        resetEditDeleteStatus = 2;
        // When Chages Data
        if (changeStatus == 1)
            OpenSaveChangesDialog();
            // When no Chages Data
        else {
            ClearOperationalMessage();
            $(".RequiredTextBox").css("border-color", "");
            //$("#txtBuyer").val("");
            GetMasterInformation();
            SelectedItemOfListOfValue('SearchWindowGrid');
            SearchWindow.open();
        }
    });

    var SearchGridDataSource = new kendo.data.DataSource({
        schema: {
            model: {
                id: "DOC_GRP_MAS_SLNO",
                fields: {
                    DOC_GRP_MAS_SLNO: { editable: false },
                    GROUP_ID: { editable: false },
                    GROUP_NAME: { editable: false },
                    DOC_GRP_DET_SLNO: { editable: false },
                    DOCTOR_NAME: { editable: false },
                    DOCTOR_ID: { editable: false }
                }
            }
        },
        pageSize: 10
    });

    var SearchGrid = $("#SearchWindowGrid").kendoGrid({
        dataSource: SearchGridDataSource,
        pageable: true,
        //groupable: true,
        editable: true,
        selectable: "row",
        navigatable: true,
        filterable: true,
        sortable: true,
        height: 320,
        columns: [
            { field: "DOC_GRP_MAS_SLNO", hidden: true },
            { field: "GROUP_NAME", title: "Group Name", width: "100px", headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;text-align: center" } },
            { field: "GROUP_ID", title: "Group Id", width: "100px", headerAttributes: { "class": "gridHeader", style: "font-weight: bold;font-size: 13px;text-align: center" } }

        ]
    });



    function GetMasterInformation() {
        $.ajax({
            url: '@Url.Action("GetSearchMasterList", "DoctorGroupMstDtl")',
            type: 'GET',
            success: function (data) {
                $("#SearchWindowGrid").data("kendoGrid").dataSource.data(data);
                //$("#PageDetailGrid").data("kendoGrid").dataSource.data(data);
            }
        });
    }

    function SearchWindowEvents() {
        var grid = $("#SearchWindowGrid").data("kendoGrid");
        var selectedItem = (grid.dataItem(grid.select())); //Selected Row
        $("#DOC_GRP_MAS_SLNO").val(selectedItem.DOC_GRP_MAS_SLNO);
        $("#GROUP_ID").val(selectedItem.GROUP_ID);
        $("#GROUP_NAME").val(selectedItem.GROUP_NAME);
        $("#SUStatus").val(1);
        $.ajax({
            url: '@Url.Action("GetSearchDetailDoctorList", "DoctorGroupMstDtl")',
            type: 'GET',
            data: { doctorGroupMstSlNo: $("#DOC_GRP_MAS_SLNO").val() },
            success: function (data33) {
                $("#PageDetailGrid").data("kendoGrid").dataSource.data(data33);
            }
        });
    }

    $("#SearchWindowGrid").dblclick(function () {
        SearchWindowEvents();
        SearchWindow.close();
    });
    $("#SearchWindowGrid").keyup(function (event) {
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if (keycode == '13') {
            SearchWindowEvents();
            SearchWindow.close();
        }
            // Close Window with escape key
        else if (keycode == '27') {
            SearchWindow.close();
        }
        event.stopPropagation();
    });
    $('#btnSearchWindowOK').click(function () {
        SearchWindowEvents();
        SearchWindow.close();
    });
    $('#btnSearchWindowCancel').click(function () {
        SearchWindow.close();
    });


    //To select the first row as default & to clear the filter while loading the grid
    function SelectedItemOfListOfValue(gridName) {
        var grid = $('#' + gridName).data("kendoGrid");
        //Reload Grid
        grid.dataSource.read();
        //Clear Filter
        $('#' + gridName).data("kendoGrid").dataSource.filter([]);
        //Select First Row
        $('#' + gridName).data().kendoGrid.bind('dataBound', function (e) {
            this.element.find('tbody tr:first').addClass('k-state-selected');
        });
    }





    //************************************  UPLOAD EXCELL FILE INTO KENDO GRID *****************************************//

    function onSelect(e) {
        //  kendoConsole.log("Select :: " + getFileInfo(e));
    }

    function onUpload(e) {
        //  kendoConsole.log("Upload :: " + getFileInfo(e));
    }

    function onSuccess(e) {
        //$("#divLoading").show();
        $.ajax({
            url: '@Url.Action("LoadExcelFile", "DoctorGroupMstDtl")',
            type: 'GET',
            data: { "fileName": $("#files").val() },
            success: function (response) {
                if (response != "") {
                    $("#PageDetailGrid").data("kendoGrid").dataSource.data(response);
                    $("#MessageText").html("Excel File Uploaded Successfully");
                    $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                } else {
                    $("#MessageText").html("Failed to Upload Excel File");
                    $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                }

                //if (response.msg.Type == 2) {
                //    ////changeStatus = 1;
                //    console.log(response);
                //    $("#PageDetailGrid").data("kendoGrid").dataSource.data(response.DoctorGroupDtlLoadList);
                //    $('#MessageText').html(response.msg.Msg);
                //    $("#MessageText").css({ 'color': 'green', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                //}
                //else {
                //    $('#MessageText').html(response.msg.Msg);
                //    $("#MessageText").css({ 'color': 'red', 'font-size': 'larger', 'font-weight': 'bold', 'text-align': 'left' });
                //}
                //$("#divLoading").hide();
            } //End of success call
        });
        //   kendoConsole.log("Success (" + e.operation + ") :: " + getFileInfo(e));
    }

    function onError(e) {
        //$('#MessageText').html(respnse.msg.Msg);
        //alert(e.Msg);
    }

    function onComplete(e) {
        // kendoConsole.log("Complete");
    }

    function onCancel(e) {
        //  kendoConsole.log("Cancel :: " + getFileInfo(e));
    }

    function onRemove(e) {
        // kendoConsole.log("Remove :: " + getFileInfo(e));
    }

    function onProgress(e) {
        //kendoConsole.log("Upload progress :: " + e.percentComplete + "% :: " + getFileInfo(e));
    }

    $(document).ready(function () {
        $("#files").kendoUpload({
            async: {
                saveUrl: "UploadFile",
                removeUrl: "Remove",
                autoUpload: true
            },
            cancel: onCancel,
            complete: onComplete,
            error: onError,
            progress: onProgress,
            remove: onRemove,
            select: onSelect,
            success: onSuccess,
            upload: onUpload
        });
    });


    //************************************  END OF UPLOAD EXCELL FILE INTO KENDO GRID **********************************//






</script>

